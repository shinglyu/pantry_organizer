<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mocha Tests</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/8.4.0/mocha.min.css" />
</head>
<body>
    <div id="mocha"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/8.4.0/mocha.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/4.3.4/chai.min.js"></script>
    <script>mocha.setup('bdd')</script>

    <!-- Include your test files here -->
    <script src="index.js"></script>

    <script>
        let localStorageBackup = null;

        before(function() {
            // Backup localStorage before all tests
            localStorageBackup = localStorage.getItem('pantryItems');
            localStorage.clear();
        });

        after(function() {
            // Restore localStorage after all tests
            localStorage.setItem('pantryItems', localStorageBackup);
        });

        describe('addPantryItem', function() {
            it('should add an item to the pantry', function() {
                localStorage.clear();
                addPantryItem('apple', '2025-01-01');
                localStorage.getItem('pantryItems').should.equal('[{"name":"apple","expiryDate":"2025-01-01"}]');
            });
            it('Add the item to the pantry, ordered by the expiary date', function() {
                localStorage.clear();
                addPantryItem('apple', '2025-01-01');
                addPantryItem('banana', '2024-03-12');
                localStorage.getItem('pantryItems').should.equal(
                    '[{"name":"banana","expiryDate":"2024-03-12"},{"name":"apple","expiryDate":"2025-01-01"}]'
                );
            });
        });
        describe('removePantryItem', function() {
            it('should remove an item from the pantry', function() {
                localStorage.clear();
                localStorage.setItem('pantryItems', '[{"name":"apple","expiryDate":"2025-01-01"}]');
                removePantryItem(0);
                localStorage.getItem('pantryItems').should.equal('[]')
            });
        });
        chai.should();
        mocha.run();
    </script>
</body>
</html>
